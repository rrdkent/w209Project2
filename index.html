<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Dan Kent's Project 2 for w209</title>




</head>
<body>
 <h1>How much time I spend on my Phone Each Day</h1> 
    <p>Data Gathered with the <a href="https://play.google.com/store/apps/details?id=com.emberify.instant"> Instant App on Google Play </a> </p>
    <p> Things to do:
    <ul>
      <li>Parse Dates</li>
      <li><s>Flip the Y Axis</s></li>
      <li>Show the X Axis</li>
      <li><s>Fit the last three bars on the SVG</s></li>
      <li>Host on I School</li>
      <li>Reorder Chart based on top hours on Phone</li>
      <li>Change x Axis from Dates to days of week</li>
      <li><s>Add Hover Color Change for selector help</s></li>
    </ul>

    </p>


<!-- Crossfilter cdn -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.12/crossfilter.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>

<script>
/* global d3 */
	//Data begins April 22nd, 2018 ends May 21st, 2018
var dataset = [237, 182, 310, 158, 159, 205, 327, 262, 229, 267, 27, 292, 216, 198, 77, 158, 211, 193, 214, 205, 119, 324, 330, 203, 214, 250, 149, 90, 205, 104]

var dates = ["22-Apr-18", "23-Apr-18", "24-Apr-18", "25-Apr-18", "26-Apr-18", "27-Apr-18", "28-Apr-18", "1-Mar-18", "2-Mar-18", "3-Mar-18", "4-Mar-18", "5-Mar-18", "6-Mar-18", "7-Mar-18", "8-Mar-18", "9-Mar-18", "10-Mar-18", "11-Mar-18", "12-Mar-18", "13-Mar-18", "14-Mar-18", "15-Mar-18", "16-Mar-18", "17-Mar-18", "18-Mar-18", "19-Mar-18", "20-Mar-18", "21-Mar-18", "22-Mar-18", "23-Mar-18"]


var days = ["Su", "M", "Tu", "W", "Th", "F", "Sa", "Su", "M", "Tu", "W", "Th", "F", "Sa", "Su", "M", "Tu", "W", "Th", "F", "Sa", "Su", "M", "Tu", "W", "Th", "F", "Sa", "Su", "Mo"]

var parseTime = d3.timeParse("%d-%b-%y");
var dates_parsed = dates.map(parseTime);
console.log(dates_parsed)
//use index to get the data from lists.  

var barPadding = 1;

var margin = {top: 0, right: 10, bottom: 50, left: 70},
    w = 900 - margin.left - margin.right,
    h = 500 - margin.top - margin.bottom;

var svg = d3.select("body")
  .append("svg")
  .attr("width", w + margin.left + margin.right)
  .attr("height", h + margin.bottom + margin.top);

var chart = svg
.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var xscale = d3.scaleBand().range([0, w]).domain(dates)
var yscale = d3.scaleLinear().range([h, 0]).domain([0, d3.max(dataset)])


chart.selectAll("rect")
  .data(dataset)
  .enter()
  .append("rect")
  .attr("y", function(d) {return yscale(d);})
  .attr("width", w / dataset.length - barPadding)
  .attr("height", function(d){return h-yscale(d);})
  .attr("x", function(d, i) { 
   return xscale(dates[i]);
})
  .attr("fill", function(d) {
return "rgb(0, 0, " + (d * .5) + ")";
})
  .on("click", function(){sortBars();})
  .on("mouseover", function() {d3.select(this)
      .attr("fill", "green");})
  .on("mouseout", function(d) {d3.select(this)
      .transition()
      .duration(250)
      .attr("fill", "rgb(0, 0, " + (d * .5) + ")");
});


chart.selectAll("text")
  .data(dataset) 
  .enter()
  .append("text")
  .attr("text-anchor", "middle")
  .text(function(d) {
    return d;
    })
.attr("x", function(d, i) {
   return xscale(dates[i]) + 12;
})
  .attr("y", function(d) {return (yscale(d) ) + 14;})
  .attr("font-family", "sans-serif")
  .attr("font-size", "11px")
  .attr("fill", "white")
  .style("text-anchor", "middle");

var xAxis = d3.axisBottom()
  .scale(xscale);

var yAxis = d3.axisLeft()
  .scale(yscale);


//Here I am creating the means to sort my bars!

var sortBars = function() {
  console.log("Arrr, here begins the sort")
  chart.selectAll("rect")
    .sort(function(a, b) {return d3.descending(a, b);})
    .attr("x", function(d, i) {return xscale(i);
});
};





svg.append("g")
    .attr("class", "x axis")
//    .attr("transform", "translate(0," + w + ")")
    .call(xAxis);

svg.append("g")
  .attr("class", "axis")
  .attr("transform", "translate(" + 55 + ",0)")
  .call(yAxis);

//Formerly @ https://codepen.io/rrdkent/pen/ZRKmeP?editors=0011 

</script>


</body>
</html>